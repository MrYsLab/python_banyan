
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.15">
    
    
      
        <title>Tutorial 6 - Integrating With A GUI Event Loop - Python Banyan</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.c382b1dc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-a-banyan-gui-component" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Python Banyan" class="md-header__button md-logo" aria-label="Python Banyan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Python Banyan
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial 6  - Integrating With A GUI Event Loop
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Python Banyan" class="md-nav__button md-logo" aria-label="Python Banyan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Python Banyan
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          User's Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User's Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User's Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../users_guide/" class="md-nav__link">
        What Is Python Banyan?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples_intro/" class="md-nav__link">
        Introduction To The Tutorials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Base Class API Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example1/" class="md-nav__link">
        Tutorial 1  - A Simple Echo Server/Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example2/" class="md-nav__link">
        Tutorial 2  - Adding Command Line Options To A Component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example3/" class="md-nav__link">
        Tutorial 3  - Distributed Applications
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example4/" class="md-nav__link">
        Tutorial 4  - Applications From Components On Differing Platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example5/" class="md-nav__link">
        Tutorial 5  - Debugging Using The Monitor
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tutorial 6  - Integrating With A GUI Event Loop
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tutorial 6  - Integrating With A GUI Event Loop
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-the-example" class="md-nav__link">
    Running The Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-example-code" class="md-nav__link">
    Exploring The Example Code
  </a>
  
    <nav class="md-nav" aria-label="Exploring The Example Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importing-tkinter" class="md-nav__link">
    Importing Tkinter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#breaking-into-the-gui-event-loop" class="md-nav__link">
    Breaking Into The GUI Event Loop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example7/" class="md-nav__link">
        Tutorial 7  - Installing Components As Executable Modules
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example8/" class="md-nav__link">
        Tutorial 8  - Using the Banyan Launcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example9/" class="md-nav__link">
        Tutorial 9  - Connecting To Multiple Backplanes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example10/" class="md-nav__link">
        Tutorial 10 - Connecting Banyan To An MQTT Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example11/" class="md-nav__link">
        Tutorial 11 - Physical Computing And GPIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        Comparing Banyan and MQTT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          The OneGPIO Project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="The OneGPIO Project" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          The OneGPIO Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gpio_intro/" class="md-nav__link">
        Introducing OneGPIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../common_messaging_protocol/" class="md-nav__link">
        The OneGPIO Messaging Protocol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../banyan_gateways/" class="md-nav__link">
        An Introduction To OneGPIO Gateways
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../additional_gateways/" class="md-nav__link">
        Additional Banyan Gateways
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../one_gpio_demos/" class="md-nav__link">
        OneGPIO Demos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-the-example" class="md-nav__link">
    Running The Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploring-the-example-code" class="md-nav__link">
    Exploring The Example Code
  </a>
  
    <nav class="md-nav" aria-label="Exploring The Example Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#importing-tkinter" class="md-nav__link">
    Importing Tkinter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#breaking-into-the-gui-event-loop" class="md-nav__link">
    Breaking Into The GUI Event Loop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="creating-a-banyan-gui-component">Creating A Banyan GUI Component</h1>
<p><img align="center" src="../images/gui_client.png"></p>
<p>This section will demonstrate how to create a Banyan compatible GUI client for the 
<a href="../example1/#the-server">simple echo server</a> example.</p>
<p>Both Banyan and GUI frameworks are implemented using <em>event loops</em>.
Because only one event loop can run within any given thread of execution,
we need to find a way for both event loops to coexist.</p>
<p>One solution is to
create a multi-threaded application with each event loop running
in its own thread. This, however, introduces unnecessary
complexity and complicates the testing and debugging efforts.</p>
<p>If you are using a GUI that provides a callback hook to allow you to link
your own code into the GUI's event loop, a much simpler solution is at hand.
The <a href="https://docs.python.org/3/library/tk.html">Tkinter GUI framework</a>
 provides such a hook, and we will integrate Banyan into our GUI using this technique. Note that many other GUI 
 frameworks also provide a callback hook. 
 The techniques shown here may also be applied similarly to those frameworks.<br />
 The <a href="https://github.com/dddomodossola/remi">remi library,</a>
 for example, uses a method called <em>idle</em> to provide the callback hook.</p>
<p>The Tkinter callback hook method is called <a href="https://www.tutorialspoint.com/after-method-in-python-tkinter"><strong><em>after</em></strong></a>.
We will pass in 2 parameters to <em>after</em>, a sleep time
in milliseconds, and the user callback function called when the sleep time expires.</p>
<p>The example code shown below illustrates integrating the Banyan receive_loop
 into the GUI event loop using the <em>after</em> method. Some discussion of Tkinter will be provided
 for clarity. However, a detailed
discussion of the Tkinter framework is beyond the scope of this document.
<a href="https://smile.amazon.com/Modern-Tkinter-Busy-Python-Developers-ebook/dp/B0071QDNLO/ref=sr_1_9?ie=UTF8&amp;qid=1528656765&amp;sr=8-9&amp;keywords=Tkinter+book">This ebook</a>
offers a concise and useful discussion of building GUIs with Tkinter. An online version may be found
<a href="https://tkdocs.com/tutorial/index.html">here</a>.</p>
<h2 id="running-the-example">Running The Example</h2>
<p>Make sure that the backplane and <a href="../example1#the-server">server</a> are running. Next, start
<a href="https://github.com/MrYsLab/python_banyan/blob/master/examples/tk_echo_client.py"><em>tk_echo_client.py</em>.</a>
After starting the GUI client code, you should see the GUI shown at the top of this section appear on your screen,
and the console should display something similar to this:</p>
<p><img align="center" src="../images/tk_echo_console.png"></p>
<p>If you press the "Send Messages" button, you should the "Messages Sent" field update to 10.
If you start the Monitor before pressing the "Send Messages" button, you can verify the messages' contents.</p>
<h2 id="exploring-the-example-code">Exploring The Example Code</h2>
<p>The code is shown below.</p>
<h3 id="importing-tkinter">Importing Tkinter</h3>
<p>Lines 27 through 34 handle the Tkinter differences for Python 2 and 3 and allow a single code source to service both Tkinter
versions.</p>
<p>Lines 37 through 39 import not only the BanyanBase class but MessagePack
and ZeroMQ as well. Our GUI component needs direct access to these packages
because portions of the Python Banyan receive_loop will be placed in
the Tkinter mainloop.</p>
<p>Lines 62 through 68 are in preparation for initializing the parent BanyanBase class on line 71.</p>
<p>Lines 77 and 78 subscribe to all topics of interest.</p>
<h3 id="breaking-into-the-gui-event-loop">Breaking Into The GUI Event Loop</h3>
<p>Line 149 uses the <em>Tkinter</em> <strong><em>after</em></strong> method. The first parameter specifies a delay
in milliseconds
before the callback function specified by the second parameter is called.</p>
<p>In this example, the callback function is the <em>get_message</em> method defined on line 156. This method
is essentially the same code normally run in the BanyanBase receive_loop. It checks to see if there any
Banyan messages to process, and if there are, it processes them. If there are no messages available, line 169 re-arms
the <em>Tkinter</em> <strong><em>after</em></strong> method to check for Banyan messages within the GUI event loop.</p>
<pre><code>     1  #!/usr/bin/env python
     2
     3  &quot;&quot;&quot;
     4  tk_echo_client.py
     5
     6  Copyright (c) 2016-2019 Alan Yorinks All right reserved.
     7
     8   Python Banyan is free software; you can redistribute it and/or
     9   modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE
    10   Version 3 as published by the Free Software Foundation; either
    11   or (at your option) any later version.
    12   This library is distributed in the hope that it will be useful,
    13   but WITHOUT ANY WARRANTY; without even the implied warranty of
    14   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
    15   General Public License for more details.
    16
    17   You should have received a copy of the GNU AFFERO GENERAL PUBLIC LICENSE
    18   along with this library; if not, write to the Free Software
    19   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
    20
    21  &quot;&quot;&quot;
    22  from __future__ import unicode_literals
    23
    24  import time
    25
    26  # python 2/3 compatibility
    27  try:
    28      from Tkinter import *
    29      from Tkinter import font
    30      from Tkinter import ttk
    31  except ImportError:
    32      from Tkinter import *
    33      import tkFont as font
    34      import ttk
    35
    36  import sys
    37  import umsgpack
    38  import zmq
    39  from python_banyan.banyan_base import BanyanBase
    40
    41
    42  # noinspection PyMethodMayBeStatic,PyUnresolvedReferences,PyUnusedLocal
    43  class TkEchoClient(BanyanBase):
    44      &quot;&quot;&quot;
    45      A graphical echo client.
    46      &quot;&quot;&quot;
    47
    48      def __init__(self, topics=['reply'], number_of_messages=10,
    49                   back_plane_ip_address=None, subscriber_port='43125',
    50                   publisher_port='43124', process_name='Banyan Echo Client'):
    51          &quot;&quot;&quot;
    52
    53          :param topics: A list of topics to subscribe to
    54          :param number_of_messages: Default number of echo messages to send
    55          :param back_plane_ip_address:
    56          :param subscriber_port:
    57          :param publisher_port:
    58          :param process_name:
    59          &quot;&quot;&quot;
    60
    61          # establish some banyan variables
    62          self.back_plane_ip_address = back_plane_ip_address
    63          self.subscriber_port = subscriber_port
    64          self.publisher_port = publisher_port
    65
    66          # subscribe to the topic
    67          if topics is None:
    68              raise ValueError('No Topic List Was Specified.')
    69
    70          # initialize the banyan base class
    71          super(TkEchoClient, self).__init__(back_plane_ip_address=back_plane_ip_address,
    72                                             subscriber_port=subscriber_port,
    73                                             publisher_port=publisher_port,
    74                                             process_name=process_name)
    75
    76          # subscribe to all topics specified
    77          for x in topics:
    78              self.set_subscriber_topic(str(x))
    79
    80          # setup root window
    81          self.root = Tk()
    82          # create content window into which everything else is placed
    83
    84          self.root.title(process_name)
    85          self.content = ttk.Frame(self.root, borderwidth=5,
    86                                   relief=&quot;sunken&quot;, padding=12)
    87
    88          # use a grid layout
    89          self.content.grid(column=0, row=0, sticky=(N, S, E, W))
    90
    91          self.content.columnconfigure(0, weight=1)
    92          self.content.rowconfigure(0, weight=1)
    93
    94          # setup some display variables
    95
    96          # messages to be sent
    97          self.messages_to_be_sent = StringVar()
    98          self.messages_to_be_sent.set('10')
    99
   100          # messages sent count
   101          self.messages_sent = StringVar()
   102          self.message_sent_count = 0
   103          self.messages_sent.set(str(self.message_sent_count))
   104
   105          # set up font variant
   106          self.larger_font = font.Font(size=12)
   107
   108          # add the widgets
   109          ttk.Label(self.content, font=self.larger_font, text=&quot;Messages To Be Sent&quot;).grid(column=3, row=1, sticky=W)
   110          ttk.Label(self.content, font=self.larger_font, text=&quot;Messages Sent&quot;).grid(column=3, row=2, sticky=W)
   111
   112          style = ttk.Style()
   113          style.configure(&quot;BW.TLabel&quot;, foreground=&quot;black&quot;, background=&quot;white&quot;)
   114
   115          ttk.Label(self.content, font=self.larger_font,
   116                    textvariable=self.messages_sent,
   117                    width=5,
   118                    anchor=E, justify=RIGHT, style=&quot;BW.TLabel&quot;).grid(column=2, row=2, sticky=W)
   119
   120          self.to_send_entry = ttk.Entry(self.content, width=5,
   121                                         font=self.larger_font,
   122                                         textvariable=self.messages_to_be_sent,
   123                                         justify='right')
   124          self.to_send_entry.grid(column=2, row=1, sticky=(W, E))
   125
   126          s = ttk.Style()
   127          s.configure('my.TButton', font=self.larger_font)
   128
   129          self.send_button = ttk.Button(self.content, text=&quot;Send Messages&quot;,
   130                                        command=self.send, style='my.TButton')
   131          self.send_button.grid(column=4, row=3, sticky=W)
   132
   133          for child in self.content.winfo_children():
   134              child.grid_configure(padx=20, pady=5)
   135
   136          self.to_send_entry.focus()
   137          self.root.bind('&lt;Return&gt;', self.send)
   138
   139          self.number_of_messages = number_of_messages
   140
   141          # sequence number of messages
   142          self.message_number = self.number_of_messages
   143
   144          # send the first message - make sure that the server is already started
   145          # self.publish_payload({'message_number': self.message_number}, 'echo')
   146          self.message_number -= 1
   147          self.root.protocol(&quot;WM_DELETE_WINDOW&quot;, self.on_closing)
   148
   149          self.root.after(1, self.get_message)
   150
   151          try:
   152              self.root.mainloop()
   153          except KeyboardInterrupt:
   154              self.on_closing()
   155
   156      def get_message(self):
   157          &quot;&quot;&quot;
   158          This method is called from the tkevent loop &quot;after&quot; call. It will poll for new zeromq messages
   159          :return:
   160          &quot;&quot;&quot;
   161          try:
   162              data = self.subscriber.recv_multipart(zmq.NOBLOCK)
   163              self.incoming_message_processing(data[0].decode(), umsgpack.unpackb(data[1]))
   164              self.root.after(1, self.get_message)
   165
   166          except zmq.error.Again:
   167              try:
   168                  time.sleep(.0001)
   169                  self.root.after(1, self.get_message)
   170
   171              except KeyboardInterrupt:
   172                  self.root.destroy()
   173                  self.publisher.close()
   174                  self.subscriber.close()
   175                  self.my_context.term()
   176                  sys.exit(0)
   177          except KeyboardInterrupt:
   178              self.root.destroy()
   179              self.publisher.close()
   180              self.subscriber.close()
   181              self.my_context.term()
   182              sys.exit(0)
   183
   184      def incoming_message_processing(self, topic, payload):
   185          # When a message is received and its number is zero, finish up.
   186          if self.message_number == 0:
   187              self.messages_sent.set(str(self.number_of_messages))
   188
   189          # bump the message number and send the message out
   190          else:
   191              self.message_number -= 1
   192              self.message_sent_count += 1
   193              self.messages_sent.set(str(self.message_sent_count))
   194
   195              # account for python2 vs python3 differences
   196              if sys.version_info[0] &lt; 3:
   197                  self.publish_payload({'message_number': self.message_number}, 'echo'.encode())
   198              else:
   199                  self.publish_payload({'message_number': self.message_number}, 'echo')
   200
   201
   202      def send(self, *args):
   203          msgs = self.to_send_entry.get()
   204          # reset the sent count variables to zero
   205          self.message_sent_count = 0
   206          self.messages_sent.set(str(self.message_sent_count))
   207
   208          # set current message number to the number of messages to be sent
   209          self.message_number = int(msgs)
   210
   211          # update the number of messages to be sent
   212          self.number_of_messages = int(msgs)
   213
   214          # account for python2 vs python3 differences
   215          if sys.version_info[0] &lt; 3:
   216              self.publish_payload({'message_number': self.message_number}, 'echo'.encode())
   217          else:
   218              self.publish_payload({'message_number': self.message_number}, 'echo')
   219
   220      def on_closing(self):
   221          &quot;&quot;&quot;
   222          Destroy the window
   223          :return:
   224          &quot;&quot;&quot;
   225          self.clean_up()
   226          self.root.destroy()
   227
   228
   229  def gui_client():
   230      TkEchoClient()
   231
   232
   233  if __name__ == '__main__':
   234      gui_client()

</code></pre>
<p><br>
<br>
Copyright (C) 2017-2020 Alan Yorinks All Rights Reserved</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../example5/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tutorial 5  - Debugging Using The Monitor" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Tutorial 5  - Debugging Using The Monitor
            </div>
          </div>
        </a>
      
      
        
        <a href="../example7/" class="md-footer__link md-footer__link--next" aria-label="Next: Tutorial 7  - Installing Components As Executable Modules" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Tutorial 7  - Installing Components As Executable Modules
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a6c66575.min.js"></script>
      
    
  </body>
</html>