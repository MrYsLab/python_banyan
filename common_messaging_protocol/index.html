<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>The OneGPIO Messaging Protocol - Python Banyan</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Introduction To The OneGPIO Message API", url: "#_top", children: [
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../banyan_gateways/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../banyan_gateways/" class="btn btn-xs btn-link">
        OneGPIO Gateways
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../gpio_intro/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../gpio_intro/" class="btn btn-xs btn-link">
        Introduction
      </a>
    </div>
    
  </div>

    

    <h1 id="introduction-to-the-onegpio-message-api">Introduction To The <em>OneGPIO</em> Message API</h1>
<p>Unlike traditional GPIO libraries that use a hardware specific <em>method call API</em> interface,
OneGPIO uses a <strong><em>Banyan Messaging API</em></strong> interface. <a href="https://github.com/MrYsLab/python_banyan/blob/master/projects/OneGPIO/message_specification/OneGPIO.pdf">The OneGPIO
Specification</a> 
provides Banyan message templates for all OneGPIO commands
and reports. The OneGPIO Specification is a hardware and computer language independent 
abstraction of GPIO operations. </p>
<p>A <strong><em>OneGPIO Command Message</em></strong> is published by a OneGPIO Application Component to transmit 
GPIO command information to the target hardware.</p>
<p>A <strong><em>OneGPIO Report Message</em></strong> is published by a OneGPIO Gateway, after receiving report data
from the target hardware.
 Because the Gateway is translating native report messages into OneGPIO messages, 
 the has the freedom to add
additional data to the report message, such as a time stamp.</p>
<p><img alt="" src="../images/one_gpio_messages.png" /></p>
<p>A command message contains the key word <strong><em>command</em></strong> and a 
report contains the key word <strong><em>report</em></strong></p>
<p>In general, a GPIO pin must have its mode set before use. 
For example to set a pin to digital output mode, you would use the following
message template:</p>
<table>
<thead>
<tr>
<th>GPIO Operation</th>
<th>OneGPIO Message</th>
</tr>
</thead>
<tbody>
<tr>
<td>Set Pin To Digital Output Mode</td>
<td>{"command": "set_mode_digital_output", "pin": PIN, "tag":”TAG” }</td>
</tr>
</tbody>
</table>
<p>When setting a pin mode, you have the option to name or <strong><em>tag</em></strong> the pin. 
This helps to improve code readability when interacting with that pin.
You may reference the pin using either its tag or pin number interchangeably.
However, if you wish to use a tag, the <strong><em>tag must be set when the pin mode is set.</em></strong></p>
<p>The <em>pin tag</em> to <em>pin number</em> mapping is automatically maintained within
the OneGPIO Gateways.</p>
<p>To illustrate let's populate the 'set_mode_digital_output' command message
to set pin 4 as a <strong>digital output</strong> pin and tag the pin with <strong>"green_led</strong>.</p>
<p><strong>{'command': 'set_mode_digital_output', 'pin': 4, 'tag': 'green_led' }</strong></p>
<p>Notice that <strong><em>pin</em></strong> is an integer and not a string.</p>
<p>All OneGPIO message <em>keys</em> are strings. Within the OneGPIO message specification, if a <em>value</em> is <em>not</em>
within quotes, then it is specified as an integer, otherwise, it is specified as a string.</p>
<p>The OneGpio command to set the state of a digital output pin is:</p>
<table>
<thead>
<tr>
<th>GPIO Operation</th>
<th>OneGPIO Message</th>
</tr>
</thead>
<tbody>
<tr>
<td>Set Digital Output Pin State</td>
<td>{"command": "digital_write", "pin": PIN, "tag": "TAG", "value": VALUE}</td>
</tr>
</tbody>
</table>
<p>Now that the pin mode has been set with a tag, we can set the green LED to <em>on</em> with the following
message: </p>
<p><strong>{'command': 'digital_write', 'tag': 'green_led', 'value': 1 }</strong></p>
<p>We do not need to specify the pin number since we specified
a tag when we set the pin mode. Also notice, that the value is an integer
and not a string.</p>
<p>If a pin tag is created when setting the pin mode, you may use either the
tag or pin number when referencing the pin in a command.</p>
<p>To port a OneGPIO application to a different hardware platform, you need only
change the pin number for the chosen
hardware platform. This can easily be implemented using command line arguments
when designing the component.  </p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../banyan_gateways/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../banyan_gateways/" class="btn btn-xs btn-link">
        OneGPIO Gateways
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../gpio_intro/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../gpio_intro/" class="btn btn-xs btn-link">
        Introduction
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>