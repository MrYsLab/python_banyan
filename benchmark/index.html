<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Comparing Banyan and MQTT - Python Banyan</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Benchmarking Banyan and MQTT", url: "#_top", children: [
              {title: "Testing Environment", url: "#testing-environment" },
              {title: "Using MQTT", url: "#using-mqtt" },
              {title: "Using Python Banyan", url: "#using-python-banyan" },
              {title: "Running the Benchmarks On A Raspberry Pi", url: "#running-the-benchmarks-on-a-raspberry-pi" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../about/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../about/" class="btn btn-xs btn-link">
        About
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../example11/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../example11/" class="btn btn-xs btn-link">
        Tutorial 11 - Physical Computing And GPIO
      </a>
    </div>
    
  </div>

    

    <h1 id="benchmarking-banyan-and-mqtt">Benchmarking Banyan and MQTT</h1>
<p>MQTT is an excellent tool if used for what it is designed - that is, publishing messages across the greater Internet.
But when traffic is limited to within a given LAN, MQTT is highly inefficient.</p>
<p>We ran a simple benchmark comparing MQTT to Python Banyan.
For each framework, the benchmark consists of a publisher that publishes 100000 messages and a subscriber that receives those messages.
The total transfer time is calculated for each, and total latency between the publisher and subscriber is explored.</p>
<p>To view the benchmark code, click on these links:</p>
<ul>
<li><a href="https://github.com/MrYsLab/python_banyan/blob/master/python_banyan/performance_comparison/mqsub.py">MQTT subscriber</a>,</li>
<li><a href="https://github.com/MrYsLab/python_banyan/blob/master/python_banyan/performance_comparison/mqpub.py">MQTT publisher</a>,</li>
<li><a href="https://github.com/MrYsLab/python_banyan/blob/master/python_banyan/performance_comparison/banyan_sub.py">Python Banyan subscriber</a>,</li>
<li><a href="https://github.com/MrYsLab/python_banyan/blob/master/python_banyan/performance_comparison/banyan_pub.py">Python Banyan publisher</a>.</li>
</ul>
<h2 id="testing-environment">Testing Environment</h2>
<p>All tests were run on Ubuntu Linux 18.10 on a computer using
an Intel Core i5-2500K CPU running at 3.30GHz.</p>
<p>Python 3.7.2 compiled with the --enable_optimizations flag set was used for both
tests.</p>
<p>Mosquitto version 1.4.15 and paho version 1.3.1 were used for the MQTT tests.</p>
<h2 id="using-mqtt">Using MQTT</h2>
<p>Here are the MQTT test results for the subscriber:</p>
<pre><code>$ python3 mqsub.py
MQSUB Connected - Expecting 100000 Messages
Task completed on:  Wed Feb 13 17:27:25 2019
100000 Total messages received in 4.819453239440918 seconds.
</code></pre>

<p>And here are the results for the MQTT publisher:</p>
<pre><code>$ python mqpub.py
MQPUB Connected - Sending 100000 messages
Task completed on:  Wed Feb 13 17:27:24 2019

</code></pre>

<p>We can see that it took a little over 4.18 seconds to send and receive the 100000 messages.</p>
<h2 id="using-python-banyan">Using Python Banyan</h2>
<p>Here are the Banyan subscriber results:</p>
<pre><code>$ python3 banyan_sub.py

************************************************************
Banyan Subscriber using Back Plane IP address: 192.168.2.189
Subscriber Port = 43125
Publisher  Port = 43124
Loop Time = 0.1 seconds
************************************************************
Expecting 100000 messages.
Task completed at:  Wed Feb 13 17:38:42 2019
100000 Total messages received in 1.695580244064331 seconds.
</code></pre>

<p>Here are the Banyan publisher results:</p>
<pre><code>$ python3 banyan_pub.py

************************************************************
Banyan publisher using Back Plane IP address: 192.168.2.189
Subscriber Port = 43125
Publisher  Port = 43124
Loop Time = 0.1 seconds
************************************************************
Publishing 100000 messages.
Task completed at:  Wed Feb 13 17:38:42 2019

</code></pre>

<p>Looking at the results, Python Banyan was almost 2.5 times faster than the MQTT.
What is more interesting is the latency between the publishers' and subscribers' completions.
Looking at the time stamps reported, MQTT had a latency of 1 second, while Banyan had a latency of 0 seconds.</p>
<h2 id="running-the-benchmarks-on-a-raspberry-pi">Running the Benchmarks On A Raspberry Pi</h2>
<p>The tests were also run on a Raspberry Pi 3 with Raspbian Stretch March 2018 release
updated and upgraded on February 14, 2019.
Python 3.6.4 was used for all tests.</p>
<p>Mosquitto version 1.4.15 and paho version 1.3.1 were used for the MQTT tests.</p>
<p>In this case, MQTT took a little over 36 seconds to complete and Banyan a little over 17.</p>
<p>Latency for MQTT was approximately 7 seconds and for Banyan, approximately 1 second. </p>
<p><br>
<br>
Copyright (C) 2017-2020 Alan Yorinks All Rights Reserved</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../about/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../about/" class="btn btn-xs btn-link">
        About
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../example11/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../example11/" class="btn btn-xs btn-link">
        Tutorial 11 - Physical Computing And GPIO
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>